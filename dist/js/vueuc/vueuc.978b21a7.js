import{e as t,F as e,C as r,d as o,p as n,A as l,i as s,r as i,h as a,y as d,t as u,m as f,q as c,Q as p,g as h,w as m,x as g,R as v}from"../@vue/@vue.a4e29d0d.js";import{a as b,o as y}from"../evtd/evtd.12f38dac.js";import{B as w,C as x,g as $}from"../seemly/seemly.4e1987a3.js";import{u as M}from"../@css-render/@css-render.7ad47e3e.js";import{f as T,u as S,o as E,i as z}from"../vooks/vooks.82a841cc.js";import{C as R}from"../css-render/css-render.d4198487.js";import{z as B}from"../vdirs/vdirs.81c4d898.js";import{R as F}from"../@juggle/@juggle.80d14552.js";function L(t,e,r="default"){const o=e[r];if(void 0===o)throw new Error(`[vueuc/${t}]: slot[${r}] is empty.`);return o()}function A(o,n=!0,l=[]){return o.forEach((o=>{if(null!==o)if("object"==typeof o)if(Array.isArray(o))A(o,n,l);else if(o.type===e){if(null===o.children)return;Array.isArray(o.children)&&A(o.children,n,l)}else o.type!==r&&l.push(o);else"string"!=typeof o&&"number"!=typeof o||l.push(t(String(o)))})),l}function X(t,e,r="default"){const o=e[r];if(void 0===o)throw new Error(`[vueuc/${t}]: slot[${r}] is empty.`);const n=A(o());if(1===n.length)return n[0];throw new Error(`[vueuc/${t}]: slot[${r}] should have exactly one child.`)}let Y=null;function j(){if(null===Y&&(Y=document.getElementById("v-binder-view-measurer"),null===Y)){Y=document.createElement("div"),Y.id="v-binder-view-measurer";const{style:t}=Y;t.position="fixed",t.left="0",t.right="0",t.top="0",t.bottom="0",t.pointerEvents="none",t.visibility="hidden",document.body.appendChild(Y)}return Y.getBoundingClientRect()}function N(t){const e=t.getBoundingClientRect(),r=j();return{left:e.left-r.left,top:e.top-r.top,bottom:r.height+r.top-e.bottom,right:r.width+r.left-e.right,width:e.width,height:e.height}}function C(t){if(null===t)return null;const e=function(t){return 9===t.nodeType?null:t.parentNode}(t);if(null===e)return null;if(9===e.nodeType)return document;if(1===e.nodeType){const{overflow:t,overflowX:r,overflowY:o}=getComputedStyle(e);if(/(auto|scroll|overlay)/.test(t+o+r))return e}return C(e)}const H=o({name:"Binder",props:{syncTargetWithParent:Boolean,syncTarget:{type:Boolean,default:!0}},setup(t){var e;n("VBinder",null===(e=l())||void 0===e?void 0:e.proxy);const r=s("VBinder",null),o=i(null);let d=[];const u=()=>{for(const t of d)b("scroll",t,c,!0);d=[]},f=new Set,c=()=>{w(p)},p=()=>{f.forEach((t=>t()))},h=new Set,m=()=>{h.forEach((t=>t()))};return a((()=>{b("resize",window,m),u()})),{targetRef:o,setTargetRef:e=>{o.value=e,r&&t.syncTargetWithParent&&r.setTargetRef(e)},addScrollListener:t=>{0===f.size&&(()=>{let t=o.value;for(;t=C(t),null!==t;)d.push(t);for(const e of d)y("scroll",e,c,!0)})(),f.has(t)||f.add(t)},removeScrollListener:t=>{f.has(t)&&f.delete(t),0===f.size&&u()},addResizeListener:t=>{0===h.size&&y("resize",window,m),h.has(t)||h.add(t)},removeResizeListener:t=>{h.has(t)&&h.delete(t),0===h.size&&b("resize",window,m)}}},render(){return L("binder",this.$slots)}}),I=o({name:"Target",setup(){const{setTargetRef:t,syncTarget:e}=s("VBinder");return{syncTarget:e,setTargetDirective:{mounted:t,updated:t}}},render(){const{syncTarget:t,setTargetDirective:e}=this;return t?d(X("follower",this.$slots),[[e]]):X("follower",this.$slots)}});const{c:P}=R();function D(t){return"string"==typeof t?document.querySelector(t):t()}const O=o({name:"LazyTeleport",props:{to:{type:[String,Object],default:void 0},disabled:Boolean,show:{type:Boolean,required:!0}},setup:t=>({showTeleport:T(u(t,"show")),mergedTo:f((()=>{const{to:e}=t;return null!=e?e:"body"}))}),render(){return this.showTeleport?this.disabled?L("lazy-teleport",this.$slots):c(p,{disabled:this.disabled,to:this.mergedTo},L("lazy-teleport",this.$slots)):null}}),V={top:"bottom",bottom:"top",left:"right",right:"left"},W={start:"end",center:"center",end:"start"},k={top:"height",bottom:"height",left:"width",right:"width"},q={"bottom-start":"top left",bottom:"top center","bottom-end":"top right","top-start":"bottom left",top:"bottom center","top-end":"bottom right","right-start":"top left",right:"center left","right-end":"bottom left","left-start":"top right",left:"center right","left-end":"bottom right"},U={"bottom-start":"bottom left",bottom:"bottom center","bottom-end":"bottom right","top-start":"top left",top:"top center","top-end":"top right","right-start":"top right",right:"center right","right-end":"bottom right","left-start":"top left",left:"center left","left-end":"bottom left"},Q={"bottom-start":"right","bottom-end":"left","top-start":"right","top-end":"left","right-start":"bottom","right-end":"top","left-start":"bottom","left-end":"top"},G={top:!0,bottom:!1,left:!0,right:!1},J={top:"end",bottom:"start",left:"end",right:"start"};const K=P([P(".v-binder-follower-container",{position:"absolute",left:"0",right:"0",top:"0",height:"0",pointerEvents:"none",zIndex:"auto"}),P(".v-binder-follower-content",{position:"absolute",zIndex:"auto"},[P("> *",{pointerEvents:"all"})])]),Z=o({name:"Follower",inheritAttrs:!1,props:{show:Boolean,enabled:{type:Boolean,default:void 0},placement:{type:String,default:"bottom"},syncTrigger:{type:Array,default:["resize","scroll"]},to:[String,Object],flip:{type:Boolean,default:!0},internalShift:Boolean,x:Number,y:Number,width:String,minWidth:String,containerClass:String,teleportDisabled:Boolean,zindexable:{type:Boolean,default:!0},zIndex:Number,overlap:Boolean},setup(t){const e=s("VBinder"),r=S((()=>void 0!==t.enabled?t.enabled:t.show)),o=i(null),n=i(null),l=()=>{const{syncTrigger:r}=t;r.includes("scroll")&&e.addScrollListener(c),r.includes("resize")&&e.addResizeListener(c)},d=()=>{e.removeScrollListener(c),e.removeResizeListener(c)};h((()=>{r.value&&(c(),l())}));const f=M();K.mount({id:"vueuc/binder",head:!0,anchorMetaName:"vueuc-style",ssr:f}),a((()=>{d()})),E((()=>{r.value&&c()}));const c=()=>{if(!r.value)return;const l=o.value;if(null===l)return;const s=e.targetRef,{x:i,y:a,overlap:d}=t,u=void 0!==i&&void 0!==a?function(t,e){const r=j();return{top:e,left:t,height:0,width:0,right:r.width-t,bottom:r.height-e}}(i,a):N(s);l.style.setProperty("--v-target-width",`${Math.round(u.width)}px`),l.style.setProperty("--v-target-height",`${Math.round(u.height)}px`);const{width:f,minWidth:c,placement:p,internalShift:h,flip:m}=t;l.setAttribute("v-placement",p),d?l.setAttribute("v-overlap",""):l.removeAttribute("v-overlap");const{style:g}=l;g.width="target"===f?`${u.width}px`:void 0!==f?f:"",g.minWidth="target"===c?`${u.width}px`:void 0!==c?c:"";const v=N(l),b=N(n.value),{left:y,top:w,placement:x}=function(t,e,r,o,n,l){if(!n||l)return{placement:t,top:0,left:0};const[s,i]=t.split("-");let a=null!=i?i:"center",d={top:0,left:0};const u=(t,n,l)=>{let s=0,i=0;const a=r[t]-e[n]-e[t];return a>0&&o&&(l?i=G[n]?a:-a:s=G[n]?a:-a),{left:s,top:i}},f="left"===s||"right"===s;if("center"!==a){const o=Q[t],n=V[o],l=k[o];if(r[l]>e[l]){if(e[o]+e[l]<r[l]){const t=(r[l]-e[l])/2;e[o]<t||e[n]<t?e[o]<e[n]?(a=W[i],d=u(l,n,f)):d=u(l,o,f):a="center"}}else r[l]<e[l]&&e[n]<0&&e[o]>e[n]&&(a=W[i])}else{const t="bottom"===s||"top"===s?"left":"top",o=V[t],n=k[t],l=(r[n]-e[n])/2;(e[t]<l||e[o]<l)&&(e[t]>e[o]?(a=J[t],d=u(n,t,f)):(a=J[o],d=u(n,o,f)))}let c=s;return e[s]<r[k[s]]&&e[s]<e[V[s]]&&(c=V[s]),{placement:"center"!==a?`${c}-${a}`:c,left:d.left,top:d.top}}(p,u,v,h,m,d),$=function(t,e){return e?U[t]:q[t]}(x,d),{left:M,top:T,transform:S}=function(t,e,r,o,n,l){if(l)switch(t){case"bottom-start":case"left-end":return{top:`${Math.round(r.top-e.top+r.height)}px`,left:`${Math.round(r.left-e.left)}px`,transform:"translateY(-100%)"};case"bottom-end":case"right-end":return{top:`${Math.round(r.top-e.top+r.height)}px`,left:`${Math.round(r.left-e.left+r.width)}px`,transform:"translateX(-100%) translateY(-100%)"};case"top-start":case"left-start":return{top:`${Math.round(r.top-e.top)}px`,left:`${Math.round(r.left-e.left)}px`,transform:""};case"top-end":case"right-start":return{top:`${Math.round(r.top-e.top)}px`,left:`${Math.round(r.left-e.left+r.width)}px`,transform:"translateX(-100%)"};case"top":return{top:`${Math.round(r.top-e.top)}px`,left:`${Math.round(r.left-e.left+r.width/2)}px`,transform:"translateX(-50%)"};case"right":return{top:`${Math.round(r.top-e.top+r.height/2)}px`,left:`${Math.round(r.left-e.left+r.width)}px`,transform:"translateX(-100%) translateY(-50%)"};case"left":return{top:`${Math.round(r.top-e.top+r.height/2)}px`,left:`${Math.round(r.left-e.left)}px`,transform:"translateY(-50%)"};default:return{top:`${Math.round(r.top-e.top+r.height)}px`,left:`${Math.round(r.left-e.left+r.width/2)}px`,transform:"translateX(-50%) translateY(-100%)"}}switch(t){case"bottom-start":return{top:`${Math.round(r.top-e.top+r.height+o)}px`,left:`${Math.round(r.left-e.left+n)}px`,transform:""};case"bottom-end":return{top:`${Math.round(r.top-e.top+r.height+o)}px`,left:`${Math.round(r.left-e.left+r.width+n)}px`,transform:"translateX(-100%)"};case"top-start":return{top:`${Math.round(r.top-e.top+o)}px`,left:`${Math.round(r.left-e.left+n)}px`,transform:"translateY(-100%)"};case"top-end":return{top:`${Math.round(r.top-e.top+o)}px`,left:`${Math.round(r.left-e.left+r.width+n)}px`,transform:"translateX(-100%) translateY(-100%)"};case"right-start":return{top:`${Math.round(r.top-e.top+o)}px`,left:`${Math.round(r.left-e.left+r.width+n)}px`,transform:""};case"right-end":return{top:`${Math.round(r.top-e.top+r.height+o)}px`,left:`${Math.round(r.left-e.left+r.width+n)}px`,transform:"translateY(-100%)"};case"left-start":return{top:`${Math.round(r.top-e.top+o)}px`,left:`${Math.round(r.left-e.left+n)}px`,transform:"translateX(-100%)"};case"left-end":return{top:`${Math.round(r.top-e.top+r.height+o)}px`,left:`${Math.round(r.left-e.left+n)}px`,transform:"translateX(-100%) translateY(-100%)"};case"top":return{top:`${Math.round(r.top-e.top+o)}px`,left:`${Math.round(r.left-e.left+r.width/2+n)}px`,transform:"translateY(-100%) translateX(-50%)"};case"right":return{top:`${Math.round(r.top-e.top+r.height/2+o)}px`,left:`${Math.round(r.left-e.left+r.width+n)}px`,transform:"translateY(-50%)"};case"left":return{top:`${Math.round(r.top-e.top+r.height/2+o)}px`,left:`${Math.round(r.left-e.left+n)}px`,transform:"translateY(-50%) translateX(-100%)"};default:return{top:`${Math.round(r.top-e.top+r.height+o)}px`,left:`${Math.round(r.left-e.left+r.width/2+n)}px`,transform:"translateX(-50%)"}}}(x,b,u,w,y,d);l.setAttribute("v-placement",x),l.style.setProperty("--v-offset-left",`${Math.round(y)}px`),l.style.setProperty("--v-offset-top",`${Math.round(w)}px`),l.style.transform=`translateX(${M}) translateY(${T}) ${S}`,l.style.setProperty("--v-transform-origin",$),l.style.transformOrigin=$};m(r,(t=>{t?(l(),p()):d()}));const p=()=>{g().then(c).catch((t=>{}))};["placement","x","y","internalShift","flip","width","overlap","minWidth"].forEach((e=>{m(u(t,e),c)})),["teleportDisabled"].forEach((e=>{m(u(t,e),p)})),m(u(t,"syncTrigger"),(t=>{t.includes("resize")?e.addResizeListener(c):e.removeResizeListener(c),t.includes("scroll")?e.addScrollListener(c):e.removeScrollListener(c)}));const v=z(),b=S((()=>{const{to:e}=t;if(void 0!==e)return e;v.value}));return{VBinder:e,mergedEnabled:r,offsetContainerRef:n,followerRef:o,mergedTo:b,syncPosition:c}},render(){return c(O,{show:this.show,to:this.mergedTo,disabled:this.teleportDisabled},{default:()=>{var t,e;const r=c("div",{class:["v-binder-follower-container",this.containerClass],ref:"offsetContainerRef"},[c("div",{class:"v-binder-follower-content",ref:"followerRef"},null===(e=(t=this.$slots).default)||void 0===e?void 0:e.call(t))]);return this.zindexable?d(r,[[B,{enabled:this.mergedEnabled,zIndex:this.zIndex}]]):r}})}});const _=new class{constructor(){this.handleResize=this.handleResize.bind(this),this.observer=new("undefined"!=typeof window&&window.ResizeObserver||F)(this.handleResize),this.elHandlersMap=new Map}handleResize(t){for(const e of t){const t=this.elHandlersMap.get(e.target);void 0!==t&&t(e)}}registerHandler(t,e){this.elHandlersMap.set(t,e),this.observer.observe(t)}unregisterHandler(t){this.elHandlersMap.has(t)&&(this.elHandlersMap.delete(t),this.observer.unobserve(t))}},tt=o({name:"ResizeObserver",props:{onResize:Function},setup(t){let e=!1;const r=l().proxy;function o(e){const{onResize:r}=t;void 0!==r&&r(e)}h((()=>{const t=r.$el;void 0!==t&&(t.nextElementSibling!==t.nextSibling&&3===t.nodeType&&""!==t.nodeValue||null!==t.nextElementSibling&&(_.registerHandler(t.nextElementSibling,o),e=!0))})),a((()=>{e&&_.unregisterHandler(r.$el.nextElementSibling)}))},render(){return v(this.$slots,"default")}});function et(t){return t instanceof HTMLElement}function rt(t){for(let e=0;e<t.childNodes.length;e++){const r=t.childNodes[e];if(et(r)&&(nt(r)||rt(r)))return!0}return!1}function ot(t){for(let e=t.childNodes.length-1;e>=0;e--){const r=t.childNodes[e];if(et(r)&&(nt(r)||ot(r)))return!0}return!1}function nt(t){if(!function(t){if(t.tabIndex>0||0===t.tabIndex&&null!==t.getAttribute("tabIndex"))return!0;if(t.getAttribute("disabled"))return!1;switch(t.nodeName){case"A":return!!t.href&&"ignore"!==t.rel;case"INPUT":return"hidden"!==t.type&&"file"!==t.type;case"BUTTON":case"SELECT":case"TEXTAREA":return!0;default:return!1}}(t))return!1;try{t.focus({preventScroll:!0})}catch(e){}return document.activeElement===t}let lt=[];const st=o({name:"FocusTrap",props:{disabled:Boolean,active:Boolean,autoFocus:{type:Boolean,default:!0},onEsc:Function,initialFocusTo:String,finalFocusTo:String,returnFocusOnDeactivated:{type:Boolean,default:!0}},setup(t){const e=x(),r=i(null),o=i(null);let n=!1,l=!1;const s="undefined"==typeof document?null:document.activeElement;function d(){return lt[lt.length-1]===e}function u(e){var r;"Escape"===e.code&&d()&&(null===(r=t.onEsc)||void 0===r||r.call(t,e))}function f(t){if(!l&&d()){const e=c();if(null===e)return;if(e.contains($(t)))return;g("first")}}function c(){const t=r.value;if(null===t)return null;let e=t;for(;!(e=e.nextSibling,null===e||e instanceof Element&&"DIV"===e.tagName););return e}function p(){var r;if(t.disabled)return;if(document.removeEventListener("focus",f,!0),lt=lt.filter((t=>t!==e)),d())return;const{finalFocusTo:o}=t;void 0!==o?null===(r=D(o))||void 0===r||r.focus({preventScroll:!0}):t.returnFocusOnDeactivated&&s instanceof HTMLElement&&(l=!0,s.focus({preventScroll:!0}),l=!1)}function g(e){if(d()&&t.active){const t=r.value,n=o.value;if(null!==t&&null!==n){const r=c();if(null==r||r===n)return l=!0,t.focus({preventScroll:!0}),void(l=!1);l=!0;const o="first"===e?rt(r):ot(r);l=!1,o||(l=!0,t.focus({preventScroll:!0}),l=!1)}}}return h((()=>{m((()=>t.active),(r=>{r?(!function(){var r;if(t.disabled)return;if(lt.push(e),t.autoFocus){const{initialFocusTo:e}=t;void 0===e?g("first"):null===(r=D(e))||void 0===r||r.focus({preventScroll:!0})}n=!0,document.addEventListener("focus",f,!0)}(),y("keydown",document,u)):(b("keydown",document,u),n&&p())}),{immediate:!0})})),a((()=>{b("keydown",document,u),n&&p()})),{focusableStartRef:r,focusableEndRef:o,focusableStyle:"position: absolute; height: 0; width: 0;",handleStartFocus:function(t){if(l)return;const e=c();null!==e&&(null!==t.relatedTarget&&e.contains(t.relatedTarget)?g("last"):g("first"))},handleEndFocus:function(t){l||(null!==t.relatedTarget&&t.relatedTarget===r.value?g("last"):g("first"))}}},render(){const{default:t}=this.$slots;if(void 0===t)return null;if(this.disabled)return t();const{active:r,focusableStyle:o}=this;return c(e,null,[c("div",{"aria-hidden":"true",tabindex:r?"0":"-1",ref:"focusableStartRef",style:o,onFocus:this.handleStartFocus}),t(),c("div",{"aria-hidden":"true",style:o,ref:"focusableEndRef",tabindex:r?"0":"-1",onFocus:this.handleEndFocus})])}});export{st as F,O as L,tt as V,Z as a,I as b,H as c};
